-- 학생
CREATE SEQUENCE D20230612P1_students_id START WITH 1;

CREATE TABLE D20230612P1_students (
  id NUMBER DEFAULT D20230612P1_students_id.NEXTVAL PRIMARY KEY,
  name VARCHAR(20) NOT NULL,
  birth TIMESTAMP NOT NULL
);

-- 계정
CREATE SEQUENCE D20230612P1_accounts_id START WITH 1;

CREATE TABLE D20230612P1_accounts (
  id NUMBER DEFAULT D20230612P1_accounts_id.NEXTVAL PRIMARY KEY,
  student_id NUMBER UNIQUE REFERENCES D20230612P1_students(id) NOT NULL,
  password VARCHAR(30) NOT NULL
);

-- 수강 신청 과목
CREATE SEQUENCE D20230612P1_departments_id START WITH 1;

CREATE TABLE D20230612P1_departments (
  id NUMBER DEFAULT D20230612P1_departments_id.NEXTVAL PRIMARY KEY,
  name VARCHAR(20) NOT NULL,
  grade NUMBER NOT NULL,
  low_score NUMBER NOT NULL,
  max_score NUMBER NOT NULL
);

-- 학생 테이블에 수강 신청 과목 ID 추가
ALTER TABLE D20230612P1_students ADD department_id NUMBER REFERENCES D20230612P1_departments(id);

-- 수강 신청 내역
CREATE SEQUENCE D20230612P1_enrolments_id START WITH 1;

CREATE TABLE D20230612P1_enrolments (
  id NUMBER DEFAULT D20230612P1_enrolments_id.NEXTVAL PRIMARY KEY,
  student_id NUMBER UNIQUE REFERENCES D20230612P1_students(id) NOT NULL,
  department_id NUMBER REFERENCES D20230612P1_departments(id) NOT NULL
);

COMMIT;

INSERT INTO D20230612P1_STUDENTS(name, birth) VALUES
  ('길동', '2000-01-01')
;
